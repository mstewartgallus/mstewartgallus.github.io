{"version":3,"file":"component---src-pages-search-jsx-8d78268959b8e2c9becb.js","mappings":"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","sources":["webpack://words-to-kick-your-teeth-out/./src/features/search/use-post-tags.js","webpack://words-to-kick-your-teeth-out/./src/features/search/use-form-state.js","webpack://words-to-kick-your-teeth-out/./src/features/search/checkbox/index.jsx","webpack://words-to-kick-your-teeth-out/./src/features/search/checkbox/checkbox.module.css","webpack://words-to-kick-your-teeth-out/./src/features/search/select/index.jsx","webpack://words-to-kick-your-teeth-out/./src/features/search/select/select.module.css","webpack://words-to-kick-your-teeth-out/./src/features/search/query/index.jsx","webpack://words-to-kick-your-teeth-out/./src/features/search/query/search-form.module.css","webpack://words-to-kick-your-teeth-out/./src/features/search/search-form/index.jsx","webpack://words-to-kick-your-teeth-out/./src/features/search/use-state.js","webpack://words-to-kick-your-teeth-out/./src/features/search/pagefind.js","webpack://words-to-kick-your-teeth-out/./src/features/search/use-search.js","webpack://words-to-kick-your-teeth-out/./src/features/search/suspense-list/index.jsx","webpack://words-to-kick-your-teeth-out/./src/features/search/result-list/index.jsx","webpack://words-to-kick-your-teeth-out/./src/pages/search.jsx"],"sourcesContent":["import { graphql, useStaticQuery } from \"gatsby\";\n\nconst usePostTagsRaw = () => useStaticQuery(graphql`\nquery {\n  allPost {\n     place: distinct(field: {places: SELECT})\n     tag: distinct(field: {tags: SELECT})\n     person: distinct(field: {people: SELECT})\n     category: distinct(field: {category: SELECT})\n  }\n}`);\n\nexport const usePostTags = () => usePostTagsRaw().allPost;\n","import { useTransition, useReducer, useCallback } from \"react\";\n\nconst initState = {\n    s: '',\n    category: new Set(),\n    tag: new Set(),\n    place: new Set(),\n    person: new Set()\n};\n\nconst reducer = (state, action) => {\n    const { type } = action;\n    switch (type) {\n    case 'set': {\n        const { name, value } = action;\n        return { ...state, [name]: value };\n    }\n\n    default:\n        return state;\n    }\n};\n\nexport const useFormState = () => {\n    const [\n        { s, category, tag, place, person },\n        dispatch\n    ] = useReducer(reducer, initState);\n    const [, startTransition] = useTransition();\n\n    const setter = useCallback(\n        (name, value) => dispatch({ type: 'set', name, value }),\n        []);\n\n    const navigate = useCallback(\n        ({s, category, tag, place, person}) =>\n        startTransition(() =>\n            dispatch({ type: 'navigate', s, category, tag, place, person })),\n        []);\n\n    return {\n        s, category, tag, place, person,\n        setter,\n        navigate\n    };\n};\n","import { forwardRef } from \"react\";\nimport { checkbox } from \"./checkbox.module.css\";\n\nconst Checkbox = (props, ref) =>\n<input className={checkbox} type=\"checkbox\" {...props} ref={ref}/>;\n\nconst CheckboxRef = forwardRef(Checkbox);\n\nexport { CheckboxRef as Checkbox, CheckboxRef as default };\n","// extracted by mini-css-extract-plugin\nexport var checkbox = \"checkbox-module--checkbox--5b819\";","import { createContext, useId, useContext } from \"react\";\nimport { Checkbox } from \"../checkbox\";\nimport { label as labelClass, select, option, optionLabel } from \"./select.module.css\";\n\nconst SelectContext = createContext(null);\nSelectContext.displayName = 'Select';\n\nexport const Select = ({ name, label, children, onChange }) =>\n<fieldset className={select} onChange={onChange}>\n    <legend className={labelClass}>{label}</legend>\n    <SelectContext.Provider value={name}>\n        {children}\n    </SelectContext.Provider>\n</fieldset>;\n\nexport const Option = ({ children, onChange, selected, value }) => {\n    const id = useId();\n    const name = useContext(SelectContext);\n\n    return <div className={option}>\n               <Checkbox id={id}\n                         name={name} value={value}\n                         onChange={onChange}\n                         checked={selected}\n               />\n               <label className={optionLabel} htmlFor={id}>{children}</label>\n           </div>;\n};\n","// extracted by mini-css-extract-plugin\nexport var label = \"select-module--label--7c67c\";\nexport var option = \"select-module--option--1e551\";\nexport var optionLabel = \"select-module--optionLabel--88466\";\nexport var select = \"select-module--select--516ad\";","import { useId } from \"react\";\nimport { Input, Button, Card } from \"@features/ui\";\nimport { legend, query, queryContent } from \"./search-form.module.css\";\n\nexport const Query = ({value, onChange}) => {\n    const id = useId();\n\n    return <fieldset className={query}>\n               <legend className={legend}>Basic</legend>\n               <Card>\n                   <span>Basic</span>\n                   <div className={queryContent}>\n                       <label htmlFor={id}>\n                           Query\n                       </label>\n                       <Input id={id}\n                              name=\"s\" type=\"search\"\n                              value={value}\n                              onChange={onChange}\n                       />\n                       <Button type=\"submit\">Search</Button>\n                   </div>\n               </Card>\n           </fieldset>;\n};\n","// extracted by mini-css-extract-plugin\nexport var legend = \"search-form-module--legend--356f7\";\nexport var query = \"search-form-module--query--b601d\";\nexport var queryContent = \"search-form-module--queryContent--db47b\";","import { useCallback, useMemo } from \"react\";\nimport { Card, Column, Hgroup, H2 } from \"@features/ui\";\nimport { Search } from \"@features/polyfill\";\nimport { Select, Option } from \"../select\";\nimport { Query } from \"../query\";\n\nconst Options = ({options, onChange, selected}) => useMemo(() => options.map(option => {\n    const checked = selected?.has(option);\n\n    return {\n        option,\n        selected: checked,\n        onChange(e) {\n            onChange(e, option, checked);\n        }\n    };\n}), [options, selected, onChange]).map(({\n    option,\n    selected,\n    onChange\n}) => <Option key={option}\n              onChange={onChange}\n              selected={selected}\n              value={option}>\n          {option}\n      </Option>);\n\nconst Selects = ({\n    state,\n    onChange\n}) => useMemo(() => state.map(({selected, options, legend, name}) => {\n    return {\n        options,\n        name,\n        legend,\n        selected,\n        onChange(e, option, checked) {\n            onChange(e, option, checked, name);\n        }\n    };\n}), [state, onChange]).map(({\n    name,\n    options,\n    legend,\n    selected,\n    onChange\n}) => <Select key={name} name={name} label={legend}>\n          <Card>\n              <span>{legend}</span>\n              <Options options={options} selected={selected} onChange={onChange} />\n          </Card>\n      </Select>\n                          );\n\nconst legends = {\n    category: 'Category',\n    place: 'Place',\n    person: 'Person',\n    tag: 'Tag'\n};\n\nexport const SearchForm = ({\n    action,\n    onSubmit,\n    tags,\n    s,\n    tag,\n    category,\n    place,\n    person,\n    set\n}) => {\n    const onChangeS = useCallback(e => set('s', e.target.value), [set]);\n\n    const selects = useMemo(() => ({ category, place, person, tag }), [category, place, person, tag]);\n\n    const onChangeSelect = useCallback((e, option, checked, name) => {\n        const old = selects[name];\n\n        const next = new Set(old);\n        if (checked) {\n            next.delete(option);\n        } else {\n            next.add(option);\n        }\n\n        set(name, next);\n    }, [set, selects]);\n\n    const theState = Object.entries(selects).map(([name, selected]) => {\n        const legend = legends[name];\n        const options = tags[name];\n        return { name, selected, legend, options };\n    });\n\n    return <Search>\n               <form rel=\"search\" action={action} onSubmit={onSubmit}>\n                   <Column>\n                       <header>\n                           <Card>\n                               <Hgroup>\n                                   <H2>Search</H2>\n                               </Hgroup>\n                           </Card>\n                       </header>\n\n                       <Query value={s} onChange={onChangeS} />\n\n                       <Selects state={theState}\n                                onChange={onChangeSelect}\n                       />\n                   </Column>\n               </form>\n           </Search>;\n};\n","import { useTransition, useReducer, useCallback } from \"react\";\n\nconst initState = [];\n\nconst reducer = (state, action) => {\n    const { type } = action;\n    switch (type) {\n    case \"init\": {\n        const { linkIds } = action;\n        return linkIds.map(id => ({ id, loaded: false }));\n    }\n\n    case \"load\": {\n        const { index, url, title } = action;\n        const { id } = state[index];\n        state = Array.from(state);\n        state[index] = { id, loaded: true, url, title };\n        return state;\n    }\n\n    default:\n        return state;\n    }\n};\n\nexport const useSearchState = () => {\n    const [\n        links,\n        dispatch\n    ] = useReducer(reducer, initState);\n    const [, startTransition] = useTransition();\n\n    const init = useCallback(\n        links => startTransition(() => dispatch({ type: 'init', linkIds: links })),\n        []);\n\n    const load = useCallback(\n        (index, url, title) =>\n        startTransition(() =>\n            dispatch({ type: 'load', index, url, title })),\n        []);\n\n    return {\n        links,\n        init,\n        load\n    };\n};\n","const maybePs = async x => {\n    try {\n        return await x;\n    } catch (e) {\n        console.warn(e);\n        return;\n    }\n};\n\n// Work around dynamically importing pagefind getting messed up by\n// webpack\nconst realImport = Function('return x => import(x);')();\n\nexport const search = async (s, opts) => {\n    const pf = await maybePs(realImport(\"/static/pagefind/pagefind.js\"));\n    if (!pf) {\n        return;\n    }\n\n    return await pf.search(s, opts);\n};\n","import { useEffect } from 'react';\nimport * as Pagefind from './pagefind.js';\n\nconst parseParams = search => {\n    const params = new URLSearchParams(search);\n    let s = params.get('s');\n    if (s === '') {\n        s = null;\n    }\n    const category = new Set(params.getAll('category'));\n    const tag = new Set(params.getAll('tag'));\n    const place = new Set(params.getAll('place'));\n    const person = new Set(params.getAll('person'));\n    return { s, category, tag, place, person };\n};\n\nexport const useSearch = (search, n, onInit, onLoad) => {\n    useEffect(() => {\n        if (!search) {\n            return;\n        }\n\n        let {s, category, tag, place, person} = parseParams(search);\n        const filters = {\n            ...(category.size > 0 ? { category: Array.from(category) } : null),\n            ...(tag.size > 0 ? { tag: Array.from(tag) } : null),\n            ...(place.size > 0 ? { place: Array.from(place) } : null),\n            ...(person.size > 0 ? { person: Array.from(person) } : null),\n        };\n\n        let ignore = false;\n        (async () => {\n            const data = await Pagefind.search(s, { filters });\n            if (ignore) {\n                return;\n            }\n\n            if (!data) {\n                return;\n            }\n\n            const posts = data.results.slice(0, n);\n\n            onInit(posts.map(post => post.id));\n\n            await Promise.all(posts.map(async (post, index) => {\n                const data = await post.data();\n                if (ignore) {\n                    return;\n                }\n\n                const { url, meta: { title } } = data;\n\n                onLoad(index, url, title);\n            }));\n        })();\n        return () => ignore = true;\n    }, [search, n, onInit, onLoad]);\n};\n","import { memo, Suspense, createContext, useContext } from \"react\";\nimport { Ul, Li } from \"@features/ui\";\n\nconst FallbackContext = createContext();\nFallbackContext.displayName = 'Fallback';\n\nconst FallbackProvider = FallbackContext.Provider;\n\nconst Fallback = () => useContext(FallbackContext);\n\nconst FallbackMemo = memo(Fallback);\n\nexport const SuspenseItem = ({children}) =>\n<Li>\n    <Suspense fallback={<FallbackMemo />}>\n        {children}\n    </Suspense>\n</Li>;\n\nexport const SuspenseList = ({children, fallback}) =>\n<Ul>\n    <FallbackProvider value={fallback}>\n        {children}\n    </FallbackProvider>\n</Ul>;\n","import { lazy } from \"react\";\nimport { A, ClickTrap } from \"@features/ui\";\nimport { SuspenseList, SuspenseItem } from \"../suspense-list\";\n\nconst Suspend = lazy(() => new Promise(r => {}));\n\nconst Result = ({loaded, url, title}) => {\n    if (!loaded) {\n        return <Suspend />;\n    }\n    return <A href={url}>{title}<ClickTrap /></A>;\n};\n\nconst Loading = () =>\n<A role=\"link\" aria-disabled=\"true\">Loading...</A>;\n\nexport const ResultList = ({links}) =>\n<SuspenseList fallback={<Loading />}>\n    {\n        links.map(link =>\n            <SuspenseItem key={link.id}>\n                <Result {...link} />\n            </SuspenseItem>)\n    }\n</SuspenseList>;\n","import { useDeferredValue, useEffect, useMemo } from \"react\";\nimport { useLocation } from \"@gatsbyjs/reach-router\";\nimport {\n    ResultList, SearchForm,\n    useSearch, usePostTags, useFormState,\n    useSearchState\n} from \"@features/search\";\nimport { BreadcrumbList, BreadcrumbItem, BreadcrumbA, Theme } from \"@features/ui\";\nimport { ViewportPage } from \"@features/page\";\nimport { useSubmit, useClient } from \"@features/util\";\nimport { useTitle } from \"../components/title.jsx\";\nimport { separator } from \"../utils/separator.js\";\n\nconst parseParams = search => {\n    const params = new URLSearchParams(search);\n    const s = params.get('s') ?? '';\n    const category = new Set(params.getAll('category'));\n    const tag = new Set(params.getAll('tag'));\n    const place = new Set(params.getAll('place'));\n    const person = new Set(params.getAll('person'));\n    return { s, category, tag, place, person };\n};\n\nconst Form = ({ onSubmit, search }) => {\n    const tags = usePostTags();\n    const {\n        s, category, tag, place, person,\n        setter,\n        navigate\n    } = useFormState();\n\n    useEffect(() => {\n        const { s, category, tag, place, person } = parseParams(search);\n        navigate({ s, category, tag, place, person });\n    }, [navigate, search]);\n\n    return <SearchForm action=\"/search\"\n                       onSubmit={onSubmit}\n\n                       tags={tags}\n                       set={setter}\n\n                       s={s}\n                       category={category}\n                       tag={tag}\n                       place={place}\n                       person={person}\n           />;\n};\n\nexport const Head = () => {\n    let { search = '' } = useLocation();\n    const client = useClient();\n    if (!client) {\n        search = '';\n    }\n\n    const title = useMemo(() => {\n        const { s } = parseParams(search);\n        if (s === '' || !s) {\n            return [];\n        }\n        return [s];\n    }, [search]);\n\n    const fulltitle = useTitle(...title, 'Search');\n    return <>\n               <title>{fulltitle}</title>\n               <link rel=\"modulepreload\" href=\"/static/pagefind/pagefind.js\" />\n               <link rel=\"preload\" href=\"/static/pagefind/wasm.en.pagefind\"\n                     as=\"fetch\" crossOrigin=\"crossOrigin\"\n                     type=\"application/octet-stream\"\n               />\n           </>;\n};\n\nconst Searcher = ({ search }) => {\n    const deferredSearch = useDeferredValue(search);\n\n    const { links, init, load } = useSearchState();\n\n    useSearch(deferredSearch, 10, init, load);\n\n    return <ResultList links={links} />;\n};\n\nconst SearchPage = () => {\n    const onSubmit = useSubmit();\n\n    let { search = '' } = useLocation();\n    const client = useClient();\n    if (!client) {\n        search = '';\n    }\n\n    const deferredSearch = useDeferredValue(search);\n    const { s = '' } = new URLSearchParams(deferredSearch);\n\n    return <Theme>\n               <ViewportPage\n                   support={<Form onSubmit={onSubmit} search={deferredSearch} />}\n                   breadcrumbs={\n                       <BreadcrumbList>\n                           <BreadcrumbA href=\"/\">Home</BreadcrumbA>\n                           <BreadcrumbItem>\n                               <span aria-current=\"page\">\n                                   Search\n                               </span>\n                           </BreadcrumbItem>\n                       </BreadcrumbList>\n                   }\n                   heading={\n                       s === '' ?\n                           <>Results</> :\n                           <>{s}{separator}Results</>\n                   }\n               >\n                   <Searcher search={deferredSearch} />\n               </ViewportPage>\n           </Theme>;\n};\n\nexport default SearchPage;\n"],"names":["usePostTags","useStaticQuery","allPost","initState","s","category","Set","tag","place","person","reducer","state","action","type","name","value","Checkbox","props","ref","_jsx","className","CheckboxRef","forwardRef","SelectContext","createContext","displayName","Select","_ref","label","children","onChange","_jsxs","Provider","Option","_ref2","selected","id","useId","useContext","checked","htmlFor","Query","Card","Input","Button","Options","options","useMemo","map","option","has","e","Selects","_ref3","_ref4","legend","_ref5","legends","SearchForm","_ref6","onSubmit","tags","set","onChangeS","useCallback","target","selects","onChangeSelect","old","next","delete","add","theState","Object","entries","_ref7","Search","rel","Column","Hgroup","H2","linkIds","loaded","index","url","title","Array","from","realImport","Function","search","async","opts","pf","x","console","warn","maybePs","useSearch","n","onInit","onLoad","useEffect","params","URLSearchParams","get","getAll","parseParams","filters","size","ignore","data","Pagefind","posts","results","slice","post","Promise","all","meta","FallbackContext","FallbackProvider","Fallback","FallbackMemo","memo","SuspenseItem","Li","Suspense","fallback","SuspenseList","Ul","Suspend","lazy","r","Result","A","href","ClickTrap","Loading","role","ResultList","links","link","_params$get","Form","setter","navigate","useFormState","dispatch","useReducer","startTransition","useTransition","Head","useLocation","useClient","fulltitle","useTitle","_toConsumableArray","concat","_Fragment","as","crossOrigin","Searcher","deferredSearch","useDeferredValue","init","load","useSearchState","SearchPage","useSubmit","Theme","ViewportPage","support","breadcrumbs","BreadcrumbList","BreadcrumbA","BreadcrumbItem","heading","separator"],"sourceRoot":""}